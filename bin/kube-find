#!/usr/bin/env bash

# USAGE: kube-find <pod-filter> <cmd>

set -e

RESET_COLORS='\033[0m'
GREEN_COLOR='\033[0;32m'

FILTER=$1
CMD=$2

PODS=`kubectl get pods -o name -l $FILTER`

for POD in $PODS
do
    echo -e "${GREEN_COLOR}$POD${RESET_COLORS}:"
    kubectl exec --stdin --tty $POD -- $CMD
done
